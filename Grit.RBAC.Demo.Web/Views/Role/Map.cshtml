@{
    ViewBag.RequireJsBundles = new string[] { "jstree-map-js" };
}
@using Grit.Utility.Web.Json
<link href="~/Content/jstree/themes/proton/style.css" rel="stylesheet" />
@section scripts {
    <script>
    require(['jquery', 'bootstrap', 'jstree-map-js'],
        function ($, bootstrap, treeMap) {
            $(document).ready(function () {
                var app = treeMap($('#ctl_tree_left'), $('#ctl_tree_right'),
                    @Html.Json(@ViewBag.LeftTree as object),
                        @Html.Json(@ViewBag.RightTree as object));
                    $("#btn_save").on('click', function(){
                        $.ajax({
                            url: "@Url.Action("Map")",
                            type: 'POST',
                            data: JSON.stringify(app.data()),
                            dataType: 'json',
                            processData: false,
                            contentType: 'application/json; charset=utf-8'
                        }).done(function (data) {
                        }).fail(function (data) {
                        }).always(function (data) {
                        });
                    });
                });
            });
    </script>
}

<nav class="navbar navbar-default navbar-static-top">
    <div class="container-fluid">
        <div class="collapse navbar-collapse">
            <button type="button" class="btn btn-default navbar-btn pull-right" id="btn_save">Save</button>
        </div>
    </div>
</nav>

<div class="row">
    <div class="col-md-6">
        <h4>Roles</h4>
        <div id="ctl_tree_left"></div>
    </div>
    <div class="col-md-6">
        <h4>Corresponding Permissions</h4>
        <div id="ctl_tree_right"></div>
    </div>
</div>

